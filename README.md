# 粤港澳大湾区（黄埔）国际算法算例大赛——急诊多器官多病种筛查 

最终初赛排名rank18（private榜）

## 比赛链接
http://123.138.24.155:30080/org/pazhoulab/competition/area/64a784500890cb0bf38b1059/content

## 环境配置
python=3.8
torch
monai

## 预训练模型
使用了CLIP-Driven-Universal-Model的unet预训练模型权重，可以通过wget https://www.dropbox.com/s/lyunaue0wwhmv5w/unet.pth 下载，md5码f6c6abc29f074c3a9257c16582a92e71

## 算法细节
由于时间原因以及预训练权重直接在赛题数据上分割效果尚可，因此本项目直接使用预训练权重进行分割任务，然后在重点在分类任务上进行改进以及fine-tune。因此理论上如果在分割任务上进一步调整有机会达到更好的效果。

（1）分割：由于使用的预训练模型是针对器官分割的，因此分割任务直接使用预训练权重进行推理。
（2）分割：首先利用分割模型的分割结果对器官ct进行裁剪切片，得到四个器官局部ct，然后使用unet预训练模型部分encoder部分作为特征提取器，然后进行二分类（对每个器官单独训练一个二分类模型，但是结构相同）。在训练的损失部分使用asymmetric loss对难样本以及正负样本进行分别加权。并且在训练过程中对局部器官图像进行随机增强。

以上思路有个性能弊端：本方法基于分割结果进行器官切片，但是模型直接预测的分割结果并不一定只有一个单一的连通图，可能存在几个离群点会干扰切片，因此在这里直接用暴力的方法——BFS（广度优先遍历）进行了后处理，这也增加了推理的时长。

## 训练流程
step1.利用预训练模型进行分割推理
step2.利用分割结果对器官进行裁剪
step3.随机增强
step4.分类模型训练